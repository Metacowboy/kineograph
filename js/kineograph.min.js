// Kineograph, a JavaScript plugin that displays frames or sequences of frames from a sprite sheet image.
// by Fabrice Lejeune for EPIC Agency, http://epic.net
// 
// Version 0.1.1
// Full source at https://github.com/epicagency/kineograph
// Copyright (c) 2012 EPIC Agency http://epic.net

// MIT License, https://github.com/epicagency/kineograph/blob/master/LICENSE.md
// This file is generated by `cake build`, do not edit it by hand.
(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this._goto=t(this._goto,this),this._normalizeFrame=t(this._normalizeFrame,this),this._calculateFrames=t(this._calculateFrames,this),this._handleImageLoad=t(this._handleImageLoad,this),this._tick=t(this._tick,this),this.getFrame=t(this.getFrame,this),this.getAnimation=t(this.getAnimation,this),this.getAnimations=t(this.getAnimations,this),this.getNumFrames=t(this.getNumFrames,this),this.advance=t(this.advance,this),this.gotoAndStop=t(this.gotoAndStop,this),this.gotoAndPlay=t(this.gotoAndPlay,this),this.stop=t(this.stop,this),this.play=t(this.play,this),this.draw=t(this.draw,this);var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;if(!e)return;e.fps&&(this._fps=e.fps);if(e.images&&e.images.length>0){this._images=[],v=e.images;for(l=0,p=v.length;l<p;l++)o=v[l],typeof o=="string"&&(f=o,o=new Image,o.src=f),this._images.push(o),!o.getContext&&!o.complete&&(this._loadCount++,this.complete=!1,o.onload=this._handleImageLoad)}if(e.frames instanceof Array){this._frames=[],m=e.frames;for(c=0,d=m.length;c<d;c++)r=m[c],this._frames.push({image:this._images[r[4]?r[4]:0],rect:{x:r[0],y:r[1],width:r[2],height:r[3]},regX:r[5]||0,regY:r[6]||0})}else r=e.frames,this._frameWidth=r.width,this._frameHeight=r.height,this._regX=r.regX||0,this._regY=r.regY||0,this._numFrames=r.count,this._loadCount===0&&this._calculateFrames();if(e.animations){this._animations=[],this._data={},g=e.animations;for(u in g){a=g[u],n={name:u};if(!isNaN(a))n.frames=[a];else if(a instanceof Array){n.frequency=a[3],n.next=a[2],n.frames=[];for(s=h=y=a[0],b=a[1];y<=b?h<=b:h>=b;s=y<=b?++h:--h)n.frames.push(s)}else n.frequency=a.frequency,n.next=a.next,i=a.frames,n.frames=typeof i=="number"?[i]:i.slice(0);n.next=n.frames.length<2||n.next===!1?null:n.next===null||n.next===!0?u:n.next,n.frequency||(n.frequency=1),this._animations.push(u),this._data[u]=n}}this.kineograph=document.createElement("IMG"),this.kineograph.src="",this.kineograph.style.display="inline-block",this.kineograph.style.position="relative",e.container?this.container=e.container:(this.container=document.createElement("DIV"),document.body.appendChild(this.container)),this.container.innerHTML="",this.container.style.width=""+this._frameWidth+"px",this.container.style.height=""+this._frameHeight+"px",this.container.style.overflow="hidden",this.container.style.position="relative",this.container.appendChild(this.kineograph),this.tick=setInterval(this._tick,1e3/this._fps)}return e.prototype.complete=!0,e.prototype.onLoadComplete=null,e.prototype.onAnimationEnd=null,e.prototype.currentFrame=-1,e.prototype.currentAnimation=null,e.prototype.paused=!0,e.prototype.spriteSheet=null,e.prototype.currentAnimationFrame=0,e.prototype._advanceCount=0,e.prototype._animations=null,e.prototype._animation=null,e.prototype._frames=null,e.prototype._images=null,e.prototype._data=null,e.prototype._loadCount=0,e.prototype._frameHeight=0,e.prototype._frameWidth=0,e.prototype._numFrames=0,e.prototype._regX=0,e.prototype._regY=0,e.prototype._fps=24,e.prototype.draw=function(){var e,t;e=this.getFrame(this.currentFrame);if(!e)return;return t=e.rect,this.kineograph.src!==e.image.src&&(this.kineograph.src=""+e.image.src),this.kineograph.style.width!==e.image.width&&(this.kineograph.style.width=""+e.image.width+"px"),this.kineograph.style.height!==e.image.height&&(this.kineograph.style.height=""+e.image.height+"px"),this.kineograph.style.left="-"+t.x+"px",this.kineograph.style.top="-"+t.y+"px",!0},e.prototype.play=function(){return this.paused=!1},e.prototype.stop=function(){return this.paused=!0},e.prototype.gotoAndPlay=function(e){return this.paused=!1,this._goto(e)},e.prototype.gotoAndStop=function(e){return this.paused=!0,this._goto(e)},e.prototype.advance=function(){return this._animation?this.currentAnimationFrame++:this.currentFrame++,this._normalizeFrame()},e.prototype.getNumFrames=function(e){var t,n;return e?(t=this._data[e],n=t?t.frames.length:0):n=this._frames?this._frames.length:this._numFrames,n},e.prototype.getAnimations=function(){return this._animations.slice(0)},e.prototype.getAnimation=function(e){return this._data[e]},e.prototype.getFrame=function(e){var t,n;return n=null,this.complete&&this._frames&&(t=this._frames[e])&&(n=t),n},e.prototype._tick=function(){var e;return e=this._animation?this._animation.frequency:1,!this.paused&&++this._advanceCount%e===0&&this.advance(),this.draw()},e.prototype._handleImageLoad=function(){if(--this._loadCount===0){this._calculateFrames(),this.complete=!0;if(this.onLoadComplete)return this.onLoadComplete()}},e.prototype._calculateFrames=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h;if(this._frames||this._frameWidth===0)return;this._frames=[],u=0,n=this._frameWidth,t=this._frameHeight,c=this._images;for(a=0,l=c.length;a<l;a++){r=c[a],e=(r.width+1)/n|0,s=(r.height+1)/t|0,o=this._numFrames>0?Math.min(this._numFrames-u,e*s):e*s;for(i=f=0,h=o-1;0<=h?f<=h:f>=h;i=0<=h?++f:--f)this._frames.push({image:r,rect:{x:i%e*n,y:(i/e|0)*t,width:n,height:t},regX:this._regX,regY:this._regY});u+=o}return this._numFrames=u},e.prototype._normalizeFrame=function(){var e;e=this._animation;if(e){if(!(this.currentAnimationFrame>=e.frames.length))return this.currentFrame=e.frames[this.currentAnimationFrame];e.next?this._goto(e.next):(this.paused=!0,this.currentAnimationFrame=e.frames.length-1,this.currentFrame=e.frames[this.currentAnimationFrame]);if(this.onAnimationEnd)return this.onAnimationEnd(e.name)}else if(this.currentFrame>=this.getNumFrames()){this.currentFrame=0;if(this.onAnimationEnd)return this.onAnimationEnd(null)}},e.prototype._goto=function(e){var t;if(!isNaN(e))return this.currentAnimation=this._animation=null,this.currentFrame=e;t=this.getAnimation(e);if(t)return this.currentAnimationFrame=0,this._animation=t,this.currentAnimation=e,this._normalizeFrame()},e}(),window.Kineograph=e}).call(this);